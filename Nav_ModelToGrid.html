<html>
    <head>
        <script src="ClientGlobalContext.js.aspx" type="text/javascript"></script>
        <script>
            document.onreadystatechange = function()
            {
                if(document.readyState=="complete")
                {
                    //documentOnLoad();
                }
            }
            function documentOnLoad(entityArray)
            {                     
                tableFill(entityArray);
                console.error("after call teble fill");
            }

            function tableFill(entityArray) 
            {
                var table = document.getElementById('creditTable');
                
                for (var i = 0; i < entityArray.length; i++) 
                {
                    let tr = document.createElement("TR");


                    let tdName = document.createElement("TD");
                    var name = entityArray[i].navde_name;
                    let txtNodeName = document.createTextNode(name);
                    tdName.appendChild(txtNodeName);
                    tdName.onclick = onClickName(entityArray[i].navde_new_creditid);


                    let tdmark = document.createElement("TD");
                    var mark = entityArray[i].navde_markname;
                    let txtNodeMark = document.createTextNode(mark);
                    tdmark.appendChild(txtNodeMark);
                    tdmark.onclick = onClickMark(entityArray[i].navde_marksid);


                    let tdperiod = document.createElement("TD");
                    var period = entityArray[i].navde_new_creditperiod;
                    let txtNodePeriod = document.createTextNode(period);
                    tdperiod.appendChild(txtNodePeriod);
                    
                    
                    tr.appendChild(tdName);
                    tr.appendChild(tdmark);
                    tr.appendChild(tdperiod);
                }
            }
            function onClickName(creditId)
            {
                var pageInput = {
                    pageType: "entityrecord",
                    entityName: "navde_new_credit",
                    entityId: creditId
                };
                var navigationOptions = {
                    target: 2,
                    height: {value: 80, unit:"%"},
                    width: {value: 70, unit:"%"},
                    position: 1
                };

                parent.Xrm.Navigation.navigateTo(pageInput,navigationOptions).then(
                    function success() {
                            // Run code on success
                    },
                    function error(error) {
                            console.error(error.message);
                    }
                );
            }
            function onClickMark(markId)
            {
                var pageInput = {
                    pageType: "entityrecord",
                    entityName: "navde_new_credit",
                    entityId: creditId
                };
                var navigationOptions = {
                    target: 2,
                    height: {value: 80, unit:"%"},
                    width: {value: 70, unit:"%"},
                    position: 1
                };

                parent.Xrm.Navigation.navigateTo(pageInput,navigationOptions).then(
                    function success() {
                            // Run code on success
                    },
                    function error(error) {
                            console.error(error.message);
                    }
                );
            }       
        </script>
    </head>
    <body>
       <table id = "creditTable">

       </table> 
    </body>
</html>